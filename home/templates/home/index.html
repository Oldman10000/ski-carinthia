{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin="" />
<link rel="stylesheet" href="{% static 'home/css/home.css' %}">
{% endblock %}

{% block content %}

{% include '../headers/home-header.html' %}

<!-- Hero Image -->
<section id="hero">
    <div class="container">
        <div class="row text-center titles">
            <div class="col-12 mb-5">
                <h1 class="light-text">Ski Carinthia</h1>
            </div>
            <div class="col-12 mt-5 mb-5">
                <p class="dark-text">Get excited by the finest mountains in the eastern alps.</p>
            </div>
        </div>
    </div>
    <a href="#" class="scroll-down blue-text" address="true">
        <i class="fas fa-arrow-alt-circle-down"></i>
    </a>
</section>

<!-- main section in index page -->
<section id="index-main">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-12 mt-5">
                <h2>Where To Go?</h2>
            </div>
            <div class="col-12 mt-5">
                <p>Carinthia has a wide range of mountains to suit every need. Find anything from family friendly
                    resorts to the
                    toughest mountains that even the most seasoned skiier will be challenged by.</p>
            </div>
        </div>
        <div class="row text-center mt-5">
            <div class="col-12 col-md-4 mt-3 mt-md-0">
                <a href="{% url 'resorts' %}?family_friendly" class="card">
                    <img src="../../../media/family-ski.jpg" class="card-img-top" alt="...">
                    <div class="card-body">
                        <h5 class="card-title">
                            Best for Families
                        </h5>
                        <p class="card-text">View all of the most family friendly ski resorts in Carinthia!</p>
                    </div>
                </a>
            </div>
            <div class="col-12 col-md-4 mt-3 mt-md-0">
                <a href="{% url 'resorts' %}?scenic" class="card">
                    <img src="../../../media/view-ski.jpg" class="card-img-top" alt="...">
                    <div class="card-body">
                        <h5 class="card-title">
                            Show me those views!
                        </h5>
                        <p class="card-text">View the carinthian resorts with the most beautiful landscapes!</p>
                    </div>
                </a>
            </div>
            <div class="col-12 col-md-4 mt-3 mt-md-0">
                <a href="{% url 'resorts' %}?large" class="card">
                    <img src="../../../media/hard-ski.jpg" class="card-img-top" alt="...">
                    <div class="card-body">
                        <h5 class="card-title">
                            I want only the biggest mountains!
                        </h5>
                        <p class="card-text">View only the largest resorts in carinthia for the biggest excitement!</p>
                    </div>
                </a>
            </div>
        </div>
        <div class="row text-center mt-5">
            <div class="col">
                <form method="GET">
                    <input type="text" class="form-control" name="q" placeholder="Find a mountain">
                </form>
            </div>
        </div>
    </div>
</section>

<section class="last-section">
    <div id="index-map">

    </div>
</section>

{% endblock %}

{% block postloadjs %}
{{ block.super }}
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>
<script>

    var resorts = {{ resorts|safe }}

    var mapTileLayers = L.tileLayer(
        "http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}", {
            attribution: "Powered by <a href='https://developers.arcgis.com/terms/attribution/' target='_blank' rel='noopener'>Esri</a>"
        });

    var map = L.map("index-map", {
        layers: [mapTileLayers],
        center: [23.5, 12],
        zoom: 2
    }).setView([46.79, 13.95], 9);

    var skiIcon = new L.Icon({
        iconUrl: "../../../media/ski-icon2.png",
        iconSize: [25, 25],
        iconAnchor: [10, 25]
    });

    resorts.forEach(resort => {

        let xReference = resort.fields.x_map_reference;
        let yReference = resort.fields.y_map_reference;

        var marker = L.marker([xReference, yReference], {
            icon: skiIcon
        }).addTo(map).bindPopup(`
            <p>${resort.fields.name}</p>
        `);

    });

</script>
<script src="{% static 'home/js/home.js' %}"></script>
{% endblock %}